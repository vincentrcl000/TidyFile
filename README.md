# TidyFile - 智能文件整理与解读系统

一个基于AI的智能文件整理和解读系统，支持文件分类、内容摘要生成、批量处理等功能。

## 🚀 主要功能

### 1. 智能文件分类
- 基于AI的文件内容分析和分类
- 支持多种文件格式（PDF、Word、TXT、图片等）
- 自动生成文件摘要和标签
- 智能匹配目标目录

### 2. 文件解读与摘要
- 单线程文件解读
- 多线程批量文件处理
- 支持多模态模型（图像分析）
- 自动生成文件内容摘要

### 3. 文章阅读助手
- 局域网访问支持
- 移动端友好界面
- 智能文件打开/下载
- 实时文件预览

### 4. 微信文章管理
- 微信文章导入和管理
- AI摘要生成
- 文章分类和标签

### 5. 重复文件清理
- 智能重复文件检测
- 批量文件去重
- 安全删除确认

## 📋 系统要求

- Python 3.8+
- Windows 10/11
- 至少 4GB 内存
- 网络连接（用于AI模型下载）

## 🛠️ 安装与启动

### 方法一：使用启动脚本（推荐）

1. **启动主程序**：
   ```
   双击运行：启动文件整理器_新版本.bat 或 启动文件整理器.vbs
   ```

2. **启动文章阅读助手**：
   ```
   双击运行：启动局域网服务器.bat
   ```

### 方法二：手动启动

1. **激活虚拟环境**：
   ```bash
   .venv\Scripts\activate
   ```

2. **启动主程序**：
   ```bash
   python gui_app_tabbed.py
   ```

3. **启动文章阅读助手**：
   ```bash
   python start_viewer_server.py
   ```

## 🎯 使用指南

### 智能文件分类

1. 启动主程序
2. 选择"AI智能分类"标签页
3. 设置源文件夹和目标文件夹
4. 调整AI参数（摘要长度、内容截取等）
5. 点击"开始分类"按钮

### 文件解读

1. 选择"文件解读"标签页
2. 选择要解读的文件夹
3. 设置解读参数
4. 点击"开始解读"按钮

### 文章阅读助手

1. 启动文章阅读助手服务器
2. 在浏览器中访问显示的地址
3. 浏览已处理的文件
4. 点击文件进行预览或下载

### 微信文章管理

1. 选择"微信文章"标签页
2. 导入微信文章文件
3. 生成AI摘要
4. 管理文章分类

## 🔧 AI模型配置

系统支持多种AI模型：

- **本地Ollama模型**：推荐使用，支持离线运行
- **局域网模型**：支持多设备共享
- **在线模型**：需要网络连接

配置文件：`ai_models_config.json`

## 🌐 局域网访问

文章阅读助手支持局域网访问：

1. 启动服务器后，会显示局域网地址
2. 同一局域网内的其他设备可以访问
3. 支持手机、平板等移动设备
4. 文件可以直接在客户端设备上打开

## 📁 项目结构

```
TidyFile/
├── gui_app_tabbed.py          # 主程序GUI
├── start_viewer_server.py     # 文章阅读助手服务器
├── viewer.html                # 文章阅读助手界面
├── file_reader.py             # 文件解读核心
├── multi_task_file_reader.py  # 批量处理
├── ai_client_manager.py       # AI客户端管理
├── smart_file_classifier.py   # 智能文件分类
├── weixin_manager_gui.py      # 微信文章管理
├── duplicate_file_remover_gui.py # 重复文件清理
├── 启动文件整理器_新版本.bat    # 主程序启动脚本
├── 启动文件整理器.vbs          # VBS启动脚本
├── 启动局域网服务器.bat        # 服务器启动脚本
└── 用户手册.md                # 详细使用说明
```

## 📝 日志和结果

- **处理结果**：`ai_organize_result.json`
- **批量处理日志**：已删除，结果统一保存到 `ai_organize_result.json`
- **系统日志**：`logs/` 目录
- **传输日志**：`transfer_logs/` 目录

## 🔍 故障排除

### 常见问题

1. **AI模型无法连接**
   - 检查Ollama服务是否启动
   - 确认模型是否已下载
   - 检查网络连接

2. **文件处理失败**
   - 检查文件权限
   - 确认文件格式支持
   - 查看错误日志

3. **局域网访问失败**
   - 检查防火墙设置
   - 确认IP地址正确
   - 检查端口是否被占用

### 诊断工具

系统提供了多个诊断工具：

- `ollama诊断工具.py`：检查Ollama服务状态
- `测试AI调用.py`：测试AI调用功能
- `测试文件解读.py`：测试文件解读功能
- `测试批量处理.py`：测试批量处理功能

## 📄 许可证

本项目采用 MIT 许可证。

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📞 支持

如有问题，请查看：
1. 用户手册：`用户手册.md`
2. 局域网访问说明：`局域网访问说明.md`
3. 项目日志文件

---

**版本**：2.0.0  
**更新时间**：2025-01-27  
**作者**：AI Assistant