# TidyFile 用户手册

## 📖 概述

TidyFile 是一个基于AI的智能文件整理和解读系统，帮助您高效管理和理解文件内容。

## 🚀 快速开始

### 1. 启动程序

**方法一：使用启动脚本（推荐）**
- 双击 `启动文件整理器_新版本.bat` 启动主程序
- 双击 `启动局域网服务器.bat` 启动文章阅读助手

**方法二：手动启动**
```bash
# 激活虚拟环境
.venv\Scripts\activate

# 启动主程序
python gui_app_tabbed.py

# 启动文章阅读助手
python start_viewer_server.py
```

### 2. 首次使用

1. **配置AI模型**：
   - 确保已安装Ollama服务
   - 下载AI模型：`ollama pull qwen3:4b`
   - 检查模型配置：`ai_models_config.json`

2. **选择功能**：
   - AI智能分类：自动分类文件
   - 文件解读：生成文件摘要
   - 微信文章：管理微信收藏
   - 重复文件：清理重复文件

## 🎯 功能详解

### 1. AI智能分类

**功能说明**：
- 使用AI分析文件内容
- 自动生成文件摘要
- 智能匹配目标目录
- 支持多种文件格式

**使用步骤**：
1. 选择"AI智能分类"标签页
2. 设置源文件夹（包含要分类的文件）
3. 设置目标文件夹（分类后的存储位置）
4. 调整AI参数：
   - 摘要长度：100-500字符
   - 内容截取：1000-5000字符
5. 点击"开始分类"

**支持的文件格式**：
- 文档：PDF、Word、TXT、MD
- 图片：JPG、PNG、GIF、BMP
- 代码：PY、JS、HTML、CSS
- 数据：JSON、XML、CSV

### 2. 文件解读

**功能说明**：
- 生成文件内容摘要
- 支持单线程和多线程处理
- 多模态模型支持（图像分析）
- 批量处理大量文件

**使用步骤**：
1. 选择"文件解读"标签页
2. 选择要解读的文件夹
3. 设置解读参数：
   - 摘要长度：100-500字符
   - 内容截取：1000-5000字符
4. 选择处理模式：
   - 单线程：适合少量文件
   - 多线程：适合大量文件
5. 点击"开始解读"

**处理结果**：
- 文件摘要保存在 `ai_organize_result.json`
- 批量处理日志保存在 `batch_read_results.json`
- 可通过文章阅读助手查看结果

### 3. 文章阅读助手

**功能说明**：
- 局域网访问支持
- 移动端友好界面
- 智能文件打开/下载
- 实时文件预览

**使用步骤**：
1. 启动文章阅读助手服务器
2. 在浏览器中访问显示的地址
3. 浏览已处理的文件列表
4. 点击文件进行预览或下载

**局域网访问**：
- 本机访问：`http://localhost`
- 局域网访问：`http://192.168.x.x`（显示在启动信息中）
- 支持手机、平板等移动设备

**文件操作**：
- 点击文件名：尝试直接打开
- 移动设备：自动下载到设备
- 桌面设备：尝试本地打开

### 4. 微信文章管理

**功能说明**：
- 导入微信收藏文章
- AI摘要生成
- 文章分类和标签
- 文章预览和渲染

**使用步骤**：
1. 选择"微信文章"标签页
2. 导入微信文章文件（JSON格式）
3. 生成AI摘要
4. 管理文章分类和标签
5. 预览和导出文章

**支持格式**：
- 微信收藏文章JSON文件
- 自动解析文章内容
- 生成结构化摘要

### 5. 重复文件清理

**功能说明**：
- 智能重复文件检测
- 基于文件内容的去重
- 安全删除确认
- 批量处理支持

**使用步骤**：
1. 选择"重复文件清理"标签页
2. 选择要检查的文件夹
3. 设置检测参数：
   - 检测模式：文件名、内容、大小
   - 相似度阈值
4. 点击"开始检测"
5. 查看检测结果并选择要删除的文件
6. 确认删除操作

## ⚙️ 配置说明

### AI模型配置

**配置文件**：`ai_models_config.json`

**配置项**：
```json
{
  "models": [
    {
      "id": "ollama-local",
      "name": "本地Ollama模型",
      "base_url": "http://localhost:11434",
      "model_name": "qwen3:4b",
      "model_type": "ollama",
      "priority": 3,
      "enabled": true
    }
  ]
}
```

**添加新模型**：
1. 编辑配置文件
2. 添加模型信息
3. 设置优先级和启用状态
4. 重启程序

### 分类规则配置

**配置文件**：`classification_rules.json`

**配置项**：
```json
{
  "rules": [
    {
      "name": "工作文档",
      "keywords": ["工作", "项目", "报告"],
      "target_folder": "工作文档"
    }
  ]
}
```

## 🔧 高级功能

### 批量处理

**适用场景**：
- 大量文件需要处理
- 需要提高处理效率
- 支持中断和恢复

**使用方法**：
1. 选择多线程模式
2. 设置并发数量
3. 监控处理进度
4. 查看处理日志

### 自定义分类规则

**创建规则**：
1. 打开分类规则管理器
2. 添加新的分类规则
3. 设置关键词和目标文件夹
4. 保存并应用规则

**规则优先级**：
- 按添加顺序匹配
- 支持正则表达式
- 支持模糊匹配

## 📊 结果管理

### 处理结果

**文件位置**：
- `ai_organize_result.json`：AI处理结果
- `batch_read_results.json`：批量处理日志
- `logs/`：系统日志目录
- `transfer_logs/`：传输日志目录

**结果格式**：
```json
{
  "处理时间": "2025-01-27 10:30:00",
  "文件名": "example.pdf",
  "文件摘要": "文档摘要内容...",
  "最终目标路径": "D:/分类结果/工作文档/example.pdf",
  "处理状态": "分类成功",
  "处理耗时": 2.5
}
```

### 日志查看

**系统日志**：
- 程序运行状态
- 错误信息记录
- 性能统计信息

**传输日志**：
- 文件移动记录
- 操作历史追踪
- 回滚操作支持

## 🔍 故障排除

### 常见问题

**1. AI模型无法连接**
- 检查Ollama服务是否启动
- 确认模型是否已下载
- 检查网络连接
- 查看错误日志

**2. 文件处理失败**
- 检查文件权限
- 确认文件格式支持
- 检查磁盘空间
- 查看错误信息

**3. 局域网访问失败**
- 检查防火墙设置
- 确认IP地址正确
- 检查端口是否被占用
- 测试网络连接

**4. 程序启动失败**
- 检查Python环境
- 确认依赖包安装
- 检查虚拟环境
- 查看启动日志

### 诊断工具

**内置诊断**：
- 模型状态检查
- 网络连接测试
- 文件权限验证
- 性能监控

**外部工具**：
- `ollama诊断工具.py`：检查Ollama服务
- `测试AI调用.py`：测试AI功能
- `测试文件解读.py`：测试文件处理
- `测试批量处理.py`：测试批量功能

## 📞 技术支持

### 获取帮助

**文档资源**：
- 本用户手册
- README.md 项目说明
- 局域网访问说明.md

**日志文件**：
- 查看 `logs/` 目录下的日志文件
- 检查错误信息和警告
- 分析性能数据

**常见解决方案**：
- 重启程序和服务
- 检查配置文件
- 更新依赖包
- 清理缓存文件

---

**版本**：2.0.0  
**更新时间**：2025-01-27  
**适用系统**：Windows 10/11