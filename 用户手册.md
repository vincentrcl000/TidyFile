# 🗂️ 智能文件整理器 - 用户手册

## 📋 目录
- [项目简介](#项目简介)
- [系统要求](#系统要求)
- [安装指南](#安装指南)
- [快速启动](#快速启动)
- [功能介绍](#功能介绍)
- [使用教程](#使用教程)
- [常见问题](#常见问题)
- [技术支持](#技术支持)

## 📖 项目简介

智能文件整理器是一个基于AI的文件自动分类和整理工具，能够：
- 🤖 使用AI智能分析文件内容和名称
- 📁 自动将文件分类到合适的文件夹
- 🎯 支持批量文件处理
- 🖥️ 提供友好的图形用户界面
- ⚡ 支持复制和移动两种操作模式
- 🔍 智能重复文件检测和删除
- 📋 详细的操作日志和转移记录
- 🔄 文件恢复功能，支持撤销操作

## 💻 系统要求

### 基本要求
- **操作系统**: Windows 10/11
- **Python版本**: 3.8 或更高版本
- **内存**: 至少 4GB RAM
- **存储空间**: 至少 2GB 可用空间

### 可选要求（AI功能）
- **GPU**: NVIDIA显卡（推荐，用于AI加速）
- **网络**: 用于下载AI模型

## 🚀 安装指南

### 步骤1：安装Python
1. 访问 [Python官网](https://www.python.org/downloads/)
2. 下载Python 3.8+版本
3. 安装时勾选"Add Python to PATH"

### 步骤2：安装Ollama（AI功能）
1. 访问 [Ollama官网](https://ollama.ai/)
2. 下载并安装Ollama
3. 安装完成后，Ollama会自动启动服务

### 步骤3：安装项目依赖
1. 打开命令提示符（CMD）
2. 进入项目目录：
   ```bash
   cd "D:\Myprojects\文件整理"
   ```
3. 安装依赖包：
   ```bash
   pip install -r requirements.txt
   ```

### 步骤4：下载AI模型（可选）
```bash
ollama pull qwen3:0.6b
```

## ⚡ 快速启动

### 方法1：双击启动（推荐）
1. 双击 `启动文件整理器.bat` 文件
2. 等待程序启动完成

### 方法2：Python脚本启动
1. 双击 `start.py` 文件
2. 或在命令行运行：
   ```bash
   python start.py
   ```

### 方法3：直接启动GUI
```bash
python gui_app.py
```

## 🎯 功能介绍

### 核心功能

#### 1. 智能文件分类
- **AI分类**: 使用本地AI模型分析文件内容
- **规则分类**: 基于文件扩展名和关键词的规则分类
- **自动降级**: AI不可用时自动切换到规则分类

#### 2. 文件操作模式
- **复制模式**: 保留原文件，在目标位置创建副本
- **移动模式**: 将文件从源位置移动到目标位置

#### 3. 批量处理
- 支持同时处理多个文件
- 实时显示处理进度
- 详细的操作日志

#### 4. 冲突处理
- 自动检测文件名冲突
- 为重复文件添加时间戳后缀
- 确保不会覆盖现有文件

#### 5. 重复文件管理
- **智能检测**: 基于文件内容的MD5哈希值检测重复文件
- **安全删除**: 提供试运行模式，预览删除结果
- **批量处理**: 支持一键删除所有重复文件
- **保护机制**: 自动保留最新或最大的文件版本

#### 6. 操作记录与恢复
- **转移日志**: 详细记录每次文件操作的完整信息
- **文件恢复**: 支持基于日志的文件恢复功能
- **操作追踪**: 可查看历史操作记录和统计信息
- **安全保障**: 提供操作撤销和文件还原机制

#### 7. 智能文档解读
- **批量扫描**: 自动识别文件夹中的可读取文档类型和数量
- **多格式支持**: 支持PDF、Word、PowerPoint、Excel、文本等多种文档格式
- **AI总结**: 使用本地AI模型对文档内容进行智能总结和分析
- **现代化界面**: 提供基于Web的现代化文档阅读界面
- **自动资源管理**: 浏览器关闭时自动停止后台服务，节省系统资源

### 界面功能

#### 分页界面

**智能分类页面**:
- **源目录选择**: 选择要整理的文件所在目录
- **目标目录选择**: 选择文件整理后的存放目录
- **AI参数设置**: 调节摘要长度和内容截取参数
- **预览分类**: 预览AI推荐的分类结果
- **智能整理**: 执行AI智能文件分类

**文件分类页面**:
- **快速分类**: 基于文件名和扩展名的规则分类
- **批量处理**: 适合简单的文件整理需求

**工具页面**:
- **转移日志**: 查看历史操作记录
- **文件恢复**: 撤销错误操作
- **删除重复文件**: 智能检测和删除重复文件
- **文件解读**: 解读各种文档格式内容
- **转换状态**: 查看文档转换状态

#### 重复文件删除界面
- **目标文件夹**: 选择要扫描重复文件的目录
- **试运行模式**: 安全预览删除结果，不实际删除文件
- **扫描结果**: 显示检测到的重复文件组和详细信息
- **批量操作**: 支持一键删除所有重复文件

#### 设置选项
- **操作模式**: 选择复制或移动模式
- **AI模型**: 选择使用的AI模型
- **日志级别**: 设置日志详细程度
- **删除策略**: 配置重复文件的保留规则

## 📚 使用教程

### 基础使用流程

#### 步骤1：启动程序
1. 双击 `启动文件整理器.bat`
2. 或者运行 `python start.py`
3. 等待程序加载完成

#### 步骤2：选择功能页面
根据需求选择相应的功能页面：
- **智能分类**: 使用AI进行智能文件分类
- **文件分类**: 使用规则进行快速文件分类
- **工具**: 使用辅助工具功能

#### 步骤3：智能分类流程
1. 在"智能分类"页面，点击"选择源目录"选择要整理的文件夹
2. 点击"选择目标目录"选择整理后文件的存放位置
3. 根据需要调整AI参数（摘要长度、内容截取长度）
4. 点击"预览分类"查看AI推荐的分类结果
5. 如果预览结果满意，点击"开始智能整理"
6. 系统会按照AI建议对所有文件进行分类整理

#### 步骤4：文件分类流程
1. 在"文件分类"页面，选择源目录和目标目录
2. 点击"开始分类"进行基于规则的快速分类
3. 适合处理大量文件的简单分类需求

#### 步骤5：工具功能使用
在"工具"页面可以使用以下功能：

**转移日志**:
1. 查看历史文件操作记录
2. 了解每次整理的详细信息

**文件恢复**:
1. 选择要撤销的操作记录
2. 点击恢复按钮撤销错误操作

**删除重复文件**:
1. 选择要检查的目录
2. 系统会扫描并列出重复文件
3. 选择要删除的重复文件

**文件解读**:
1. 选择包含文档的文件夹
2. 系统自动扫描并显示可读取的文档数量（支持.txt、.pdf、.docx、.pptx、.xlsx等格式）
3. 点击"开始批量解读"进行批量文档内容提取和AI总结
4. 解读结果会在网页查看器中显示，支持现代化的阅读界面
5. 浏览器关闭时服务器自动停止，节省系统资源

**转换状态**:
1. 查看文档转换的进度和状态
2. 了解转换过程中的详细信息

### 高级使用技巧

#### 1. AI分类优化
- **调整AI参数**：
  - 摘要长度：根据文件复杂度调整，复杂文档可设置更长摘要
  - 内容截取长度：大文件可适当增加截取长度以获得更准确分类
- **提供清晰的目标目录结构**：在目标目录中预先创建有意义的文件夹
- **文件命名规范**：规范的文件名有助于AI更好地理解文件内容
- **查看JSON输出**：检查`preview_ai_result.json`了解AI分类的详细过程

#### 2. 功能选择建议
- **智能分类**：适合文档类文件，需要根据内容进行精确分类
- **文件分类**：适合大量文件的快速整理，基于文件名和扩展名
- **文件解读**：用于批量解读文档内容，自动扫描文件夹中的可读取文档，支持多种格式
- **重复文件清理**：定期使用以释放存储空间

#### 3. 批量处理大量文件
- 建议分批处理，每次不超过1000个文件
- 处理前先备份重要文件
- 使用复制模式进行首次测试
- **合理使用预览功能**：大量文件时先预览少量文件确认效果

#### 4. AI模型选择
- `qwen2:0.5b`: 轻量级模型，速度快，适合日常使用
- `gemma2:2b`: 中等模型，平衡性能和准确度
- 根据硬件配置选择合适的模型

#### 4. 重复文件清理策略
- 首次使用建议开启试运行模式
- 定期清理下载文件夹和临时目录
- 清理前确保重要文件已备份
- 可按文件类型分别处理（如图片、文档等）

#### 5. 操作日志管理
- 定期查看转移日志了解文件变动
- 重要操作前记录当前状态
- 利用文件恢复功能撤销错误操作
- 保留关键操作的日志文件作为备份

## ❓ 常见问题

### Q1: 程序启动失败怎么办？
**A**: 检查以下项目：
1. Python是否正确安装
2. 依赖包是否完整安装
3. 是否有足够的系统权限
4. 查看错误日志获取详细信息

### Q2: AI分类不准确怎么办？
**A**: 可以尝试：
1. 更换更大的AI模型
2. 优化目标文件夹的命名
3. 使用规则分类作为备选
4. 手动调整分类结果

### Q3: Ollama服务无法启动？
**A**: 解决方案：
1. 检查端口11434是否被占用
2. 重新安装Ollama
3. 使用管理员权限启动
4. 程序会自动降级到规则分类

### Q4: 文件处理速度慢？
**A**: 优化建议：
1. 减少单次处理的文件数量
2. 使用SSD硬盘
3. 关闭不必要的后台程序
4. 选择较小的AI模型

### Q5: 如何备份和恢复？
**A**: 建议做法：
1. 首次使用时选择复制模式
2. 定期备份重要文件
3. 保留操作日志以便追踪
4. 测试无误后再使用移动模式
5. 使用内置的文件恢复功能撤销错误操作

### Q6: 重复文件删除安全吗？
**A**: 安全保障措施：
1. 默认启用试运行模式，先预览再删除
2. 基于文件内容哈希值精确识别重复文件
3. 自动保留最新或最大的文件版本
4. 详细的删除日志记录所有操作
5. 建议重要文件先备份再进行清理

### Q7: 如何查看和管理操作历史？
**A**: 操作记录管理：
1. 点击"转移日志"按钮查看历史操作
2. 日志包含文件路径、操作时间、操作类型等详细信息
3. 使用"文件恢复"功能撤销特定操作
4. 日志文件保存在transfer_logs目录中
5. 可导出日志文件进行外部分析

## 📁 文件结构说明

```
文件整理器/
├── 启动文件整理器.bat     # Windows批处理启动脚本
├── 创建桌面快捷方式.bat   # 创建桌面快捷方式脚本
├── start.py               # Python启动脚本
├── gui_app.py            # 图形用户界面主程序
├── file_organizer.py     # 核心文件整理逻辑
├── transfer_log_manager.py # 转移日志管理器
├── build_exe.py          # 可执行文件构建脚本
├── requirements.txt      # 依赖包列表
├── README.md             # 项目说明文档
├── 用户手册.md           # 本用户手册
├── .gitignore            # Git忽略文件配置
└── tests/                # 测试文件目录
    ├── test_data/        # 测试数据
    │   ├── source_files/ # 测试源文件
    │   └── target_folders/ # 测试目标文件夹
    ├── test_data_generator.py # 测试数据生成器
    ├── test_file_organizer.py # 文件整理功能测试
    └── test_ollama_connection.py # AI连接测试
```

## 🔧 技术支持

### 日志文件位置
- 程序运行日志保存在 `logs/` 目录下
- 文件转移日志保存在 `transfer_logs/` 目录下
- 日志文件名格式：`file_organizer_YYYYMMDD_HHMMSS.log`
- 转移日志格式：`transfer_YYYYMMDD_HHMMSS.json`
- 包含详细的操作记录、错误信息和文件变动历史

### 配置文件
- 程序配置保存在代码中
- 可以通过修改源代码调整默认设置
- 建议备份原始文件后再修改

### 性能监控
- 查看任务管理器中的CPU和内存使用情况
- 监控磁盘I/O性能
- 根据系统性能调整处理批次大小

### 故障排除步骤
1. 查看最新的日志文件
2. 检查系统资源使用情况
3. 验证文件权限设置
4. 重启相关服务
5. 重新安装依赖包

## 📞 联系方式

如果遇到问题或需要技术支持，请：
1. 查看日志文件获取错误详情
2. 检查本手册的常见问题部分
3. 确保按照安装指南正确配置环境

---

**版本信息**: v2.0.1  
**更新日期**: 2025年1月  
**兼容性**: Windows 10/11, Python 3.8+  
**新增功能**: 重复文件删除、文件恢复、转移日志管理、可执行文件构建、批量文档解读、智能资源管理

🎉 感谢使用智能文件整理器！